---
title: "Final Project"
output: html_notebook
Name: 'Daniel Lee'
---

### IDEA

The main goal of this final project is to analyze how variables such as age, batting average and salary of the players are related by joining two different tables which are 'Player Standard Batting' and 'Salary'. These two tables will be analyzed separately and joined together to look for the relationship between the variables. 

### Setup
```{r}
rm(list = ls())
library(lubridate)
library(tidyverse)
library(mosaic)
library(rvest)
```

### Loading datasets
```{r}
library(readxl)
Player_Standard_Batting <- read_excel("~/Desktop/Penn State/Courses/STAT 184/Final Project/Player Standard Batting.xlsx")
View(Player_Standard_Batting)
library(readxl)
Salary <- read_excel("~/Desktop/Penn State/Courses/STAT 184/Final Project/Salary.xlsx")
View(Salary)
```

### Data Wrangling using 'Player Standard Batting' table
```{r}
# Creating a new table (PSB) with variables that are necessary and significant & erasing rows that contain NAs.
PSB <- 
  Player_Standard_Batting %>%
  select(Name, Tm, Lg, Age, R, H, HR, RBI, AB, BA, POS) 

str(Player_Standard_Batting)

# Average Hits and Batting aveage
PSB %>%
  summarise(BA = mean(BA, na.rm = TRUE) , H = mean(H, na.rm = TRUE)) # Pitchers Batting Average excluded 

# Most Hits and Batting aveage
PSB %>%
  filter(AB >= 300) %>%        # Filtering out players who were not at bat less than 300 games
  summarise(BA = max(BA, na.rm = TRUE), H = max(H, na.rm = TRUE))
```

```{r}
# Counting the number of players who are 27 years old in each team & Removing pitchers and duplicated names from the data table occured due to trade during season.

PSB %>%
  group_by(Tm) %>%
  filter(Age >= 27) %>%
  filter(POS != "1") %>%                     # Pitchers have a number position = 1 
  summarise(count = n( )) %>%
  arrange(desc(count))

```

### Data Wrangling using 'Salary' table
```{r}
# Number of players who earned more than the average salary ($4,520,000) for each team in 2018
Salary %>%
  group_by(Tm) %>%
  filter(AVG > 4520000) %>%
  filter(POS != "1") %>%         # Pitchers have a number position = 1 / POS does not work 
  summarise(count = n( )) %>%
  arrange(desc(count))

# 

```

### Joining two tables = 'Player Standard Batting' & 'Salary'
```{r}
MLB <-
  PSB %>%
  inner_join(Salary) %>%
  select(Name)

View(MLB)


Salary %>%
  select(Name, Tm, POS, `AVG ANNUAL`) %>%
```


