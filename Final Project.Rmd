---
title: "Final Project"
output: html_notebook
Name: Daniel Lee
---

### Setup
```{r}
rm(list = ls())
library(lubridate)
library(tidyverse)
library(mosaic)
library(rvest)
```

### URL & xpath (Not working & Need to be fixed)
```{r}
download.file(url = "https://www.baseball-reference.com/leagues/MLB/2018-standard-pitching.shtml", destfile = "Batting")

XPATH <- '//*[@id="players_standard_batting"]'

DataTable <- readRDS("Batting")

web_page <- "https://www.baseball-reference.com/leagues/MLB/2018-standard-pitching.shtml", destfile = "Batting"

```

## Column 'POS' cannot be found..
```{r}
# Creating a new table (MLB) with variables that are necessary and significant & erasing rows that contain NAs.
MLB <- 
  Player_Standard_Batting %>%
  select(Name, Tm, Age, R, H, HR, RBI, BA) # POS should be included but could not be found..

str(MLB)

# Average Hits and Batting aveage
MLB %>%
  summarise(BA = mean(BA, na.rm = TRUE) , H = mean(H, na.rm = TRUE)) # Pitchers Batting Average excluded 


```

## Need to be improved
```{r}
# Counting the number of players who are 27 years old in each team & Removing pitchers and duplicated names from the data table occured due to trade during season.

MLB %>%
  group_by(Tm) %>%
  filter(Age >= 27) %>%
  filter(POS != "1", na.rm == TRUE) %>%       # Pitchers have a number position = 1
  summarise(count = n( ))

```

## Relationship between age and hit
```{r}
MLB %>%
  ggplot(aes(x= Age, y= H)) + 
  geom_density() +
  xlab("Age (yrs)") + ylab("Single Hits")
```

